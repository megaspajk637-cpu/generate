name: Deploy to GitHub Pages

on:
  push:
    branches: ["main"]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pages: write      # –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Replace API Key placeholder
        env:
          MY_API_KEY: ${{ secrets.API_KEY }} # –ü–µ—Ä–µ–¥–∞–µ–º —á–µ—Ä–µ–∑ env –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        run: |
          echo "üîë –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –∫–ª—é—á..."
          # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ sed
          sed -i "s|__MY_API_KEY__|$MY_API_KEY|g" index.js
          echo "‚úÖ –ì–æ—Ç–æ–≤–æ!"

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v4 # –û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–æ v4
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./
